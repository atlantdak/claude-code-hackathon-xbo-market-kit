{
  "hooks": [
    {
      "type": "PreToolUse",
      "matcher": "Write|Edit",
      "hooks": [
        {
          "type": "command",
          "command": "bash -c 'FILE=\"$TOOL_INPUT_FILE_PATH\"; if [[ \"$FILE\" == *xbo-market-kit*.php ]]; then php -l \"$FILE\" 2>&1 || echo \"BLOCK: PHP syntax error in $FILE\"; fi'",
          "timeout": 10
        }
      ]
    },
    {
      "type": "PostToolUse",
      "matcher": "Write|Edit",
      "hooks": [
        {
          "type": "command",
          "command": "bash -c 'FILE=\"$TOOL_INPUT_FILE_PATH\"; PLUGIN_DIR=\"wp-content/plugins/xbo-market-kit\"; if [[ \"$FILE\" == *xbo-market-kit*.php ]] && command -v \"$PLUGIN_DIR/vendor/bin/phpcbf\" &>/dev/null; then cd \"$(dirname \"$FILE\")\" && \"$PLUGIN_DIR/vendor/bin/phpcbf\" --standard=\"$PLUGIN_DIR/phpcs.xml\" \"$FILE\" 2>/dev/null; fi'",
          "timeout": 30
        }
      ]
    },
    {
      "type": "Stop",
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bash \".claude/plugins/xbo-ai-flow/scripts/update-metrics-totals.sh\"",
          "timeout": 120
        },
        {
          "type": "prompt",
          "prompt": "Session metrics were auto-updated in docs/metrics/sessions.json and docs/metrics/tasks.json.\n\n1. Commit metrics: `git add docs/metrics/ && git commit -m 'docs: auto-update session metrics'`\n2. Optionally update README.md dashboard KPIs from docs/metrics/sessions.json totals (cost, tokens, sessions, messages).\n\nDo NOT push."
        }
      ]
    }
  ]
}
