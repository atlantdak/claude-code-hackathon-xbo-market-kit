# 2026-02-27 — Block Settings: Trading Pair Selector

## Summary

Replaced manual TextControl inputs with searchable dropdowns in all Gutenberg block settings. New REST endpoint `GET /xbo/v1/trading-pairs` provides 280 pair symbols. Shared React hook `useTradingPairs()` caches API data for the editor session. `PairSelector` (ComboboxControl) serves single-pair blocks, `PairsSelector` (FormTokenField) serves multi-pair Ticker block.

## Time Tracking

| Phase | Duration |
|-------|----------|
| Plan review + worktree setup | ~5 min |
| Task 1: TradingPairsController (TDD) | ~10 min |
| Tasks 3-5: React hook + components | ~5 min |
| Tasks 6-10: Block updates + build | ~10 min |
| Task 12: Manual verification (Chrome DevTools) | ~10 min |
| Post-implementation workflow | ~15 min |
| **Total** | **~55 min** |

## Completed

- [x] `TradingPairsController` — PHP REST endpoint with `extract_symbols()` static method
- [x] 3 PHPUnit tests for `TradingPairsController`
- [x] `useTradingPairs()` — React hook with module-level caching
- [x] `PairSelector` — ComboboxControl wrapper for single pair
- [x] `PairsSelector` — FormTokenField wrapper for multi-pair
- [x] Normalized `block.json` defaults to SLASH format
- [x] Updated Ticker, OrderBook, Trades, Slippage block `index.js`
- [x] JS build successful (webpack, 5 blocks)
- [x] Manual testing via Chrome DevTools: 280 pairs loaded, filtering works, selection updates preview

## Commits

| Hash | Message |
|------|---------|
| 8141a4a | feat(rest): add TradingPairsController endpoint GET /xbo/v1/trading-pairs |
| f6f91ca | fix(blocks): normalize symbol defaults to SLASH format (BTC/USDT) |
| 24c1ea4 | feat(blocks): add PairSelector and PairsSelector shared editor components |

## Metrics

| Metric | Value |
|--------|-------|
| Commits | 3 |
| Tests | 62 (3 new) |
| Assertions | 825 |
| PHPCS errors | 0 (in new code) |
| PHPStan errors | 0 (in new code) |
| JS build | Success (5 blocks) |

## Decisions

- **Module-level caching in useTradingPairs**: Cached at module scope so all block instances share one API request per editor session
- **ComboboxControl over SelectControl**: 280 pairs need searchable filtering, not a static dropdown
- **FormTokenField for Ticker**: Multi-pair selection with validation against known pairs
- **SLASH format normalization**: All attributes store SLASH format (BTC/USDT), PHP ApiClient handles conversion internally

## Files Changed

| Status | File |
|--------|------|
| A | includes/Rest/TradingPairsController.php |
| A | tests/Unit/Rest/TradingPairsControllerTest.php |
| M | includes/Plugin.php |
| A | src/blocks/shared/useTradingPairs.js |
| A | src/blocks/shared/PairSelector.js |
| A | src/blocks/shared/PairsSelector.js |
| M | src/blocks/ticker/index.js |
| M | src/blocks/orderbook/index.js |
| M | src/blocks/trades/index.js |
| M | src/blocks/slippage/index.js |
| M | src/blocks/orderbook/block.json |
| M | src/blocks/slippage/block.json |
